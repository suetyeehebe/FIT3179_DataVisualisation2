<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/grids-responsive-min.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>

    <title>Tracing the Changing Faces of Mortality in Malaysia</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="css/style.css" media="all">
</head>
<body>
    <div class="page">

    <!-- pure grid group -->
    <div id="c-align" class="pure-g">
      <div class="pure-u-1-1">
        <h1>Tracing the Changing Faces of Mortality in Malaysia</h1>
        <p>Where death rates are highest, how they changed, and how income and healthcare access relate across Malaysian states.</p>

        <!-- div class="kpi">Latest national death rate: <strong id="kpi-latest">‚Äî</strong></div -->
      </div>
    </div>
    <!-- end pure grid group -->


    <!-- pure grid group -->
    <div class="pure-g">
      <div class="pure-u-1-1">

        <h2>Overview (2022)</h2> 

        <!-- KPI tiles -->
        <div class="pure-g kpis">
            <div class="pure-u-1-3">
                <div id="c-align" class="kpi-tile">
                    <div class="kpi-label">‚ö∞Ô∏è</div>
                    <div class="kpi-value" id="kpi-death-rate">5.9</div>
                    <div class="kpi-footnote">Deaths per 1,000 population</div>
                </div>
            </div>
            <div class="pure-u-1-3">
                <div id="c-align" class="kpi-tile">
                    <div class="kpi-label">üí∞</div>
                    <div class="kpi-value" id="kpi-income">RM 6338</div>
                    <div class="kpi-footnote">Median household income</div>
                </div>
            </div>
            <div class="pure-u-1-3">
                <div id="c-align" class="kpi-tile">
                    <div class="kpi-label">üè•</div>
                    <div class="kpi-value" id="kpi-staff">167690</div>
                    <div class="kpi-footnote">Healthcare staff per 10,000 population</div>
                </div>
            </div>
        </div>

        <div class="pure-u-1-1">
            <div id="visMap" class="vis-container"></div>
        </div>

      </div>
    </div>
    <!-- end pure grid group -->

    <!-- pure grid group -->
    <div class="pure-g">
     
        <h2>How are income and death rates linked?</h2>

        <div class="pure-u-3-4">
                <div id="visBubble" class="vis-container"></div>
        </div>

        <div class="pure-u-1-4">
            <p class="pad-left side-caption">
                Most states form a gentle downward slope: <span class="bold">higher median income</span> tends to pair with <span class="bold">lower death rates</span>. 
                Larger bubbles at similar income levels often coincide with lower death rates, suggesting that better healthcare staffing may help mitigate risk even where incomes are comparable.
                Putrajaya stands out with high income and one of the lowest death rates, its large bubble reflecting dense healthcare capacity. 
                Meanwhile, Kuala Lumpur and Selangor sit mid-low on mortality despite high income, reinforcing the idea that access to healthcare resources plays a critical role in reducing mortality beyond economic factors alone.

            </p>
        </div>

    </div>
    <!-- end pure grid group -->

    <!-- pure grid group -->
    <div class="pure-g">
        <div class="pure-u-1-1">
            <h2>How have death rate ranks changed?</h2> 
        </div>

        <div class="pure-u-3-4">
            <div id="visBump" class="vis-container"></div>
        </div>

        <div class="pure-u-1-4">
            <p class=" pad-left side-caption">
                Perak stays near the top across the series, while Kedah rises into the top ranks in the early 2020s.
                Kelantan drifts toward lower ranks around 2021-2022, and Johor settles near the bottom by 2023.
                The crossing lines highlight that rank movements are not uniform-some states improve as others worsen.
            </p>
        </div>

    </div>
    <!-- end pure grid group -->

    <!-- pure grid group -->
    <div class="pure-g">
        <div class="pure-u-1-1">
            <h2>What are Malaysians dying from?</h2> 
        </div>

        <div class="pure-u-1-4">
            <p class="pad-right">
                From 2000 to 2020, Malaysia's causes of death shifted decisively toward chronic non-communicable diseases. 
                <span class="bold heart_text">Ischaemic heart disease</span> and <span class="bold cereb_text">cerebrovascular disease</span> expanded sharply to dominate the mortality 
                profile, while <span class="bold resp_text">lower respiratory infections</span> and <span class="bold accident_text">road traffic accidents</span> contributed smaller, steadier shares. 
                <span class="bold diabetes_text">Diabetes mellitus</span> appeared briefly in the early 2000s before disappearing, suggesting limited or reclassified reporting.
            </p>
        </div>

        <div class="pure-u-3-4">
            <div id="visCausesOverTime" class="vis-container"></div>
        </div>
    </div>
    <!-- end pure grid group -->

    <!-- pure grid group -->
    <div class="pure-g demographics">
        <div class="pure-u-1-1">
            <h2>Demographics: Who is most affected?</h2> 
        </div>

        <div class="pure-u-3-4"> 
            <div id="visDiverging" class="vis-container"></div>
        </div>

        <div id = "l-align" class="pure-u-1-4">
            <h3 class="pad-left">Gaps that matter</h3>
            <p class="pad-left">
                Across every state, male death rates exceed female death rates, and the gap is substantial in several places.
                The consistent left-lean of the bars confirms a systemic sex disparity rather than isolated anomalies. The
                magnitude of the gap varies by state, suggesting local factors, such as occupational risks, behaviour, or access,
                may amplify or dampen the difference.
            </p>
        </div>

    </div>
    
    <div class="pure-g demographics">
        <div class="pure-u-3-4">
            <div id="visAgeCause" class="vis-container"></div>
        </div>
        <div class="pure-u-1-4">
            <p class="pad-left">
                Cause composition changes sharply with age. Early childhood is dominated by perinatal and congenital conditions,
                adolescence and early adulthood show a prominent road-traffic component, and the picture transitions toward chronic
                cardiopulmonary diseases from mid-life onward. By ages 55-74 and 75+, ischaemic heart diseases and lower respiratory infections account for the largest shares, with chronic obstructive pulmonary disease increasingly visible in the oldest group.
            </p>
        </div>
    </div>
    <!-- end pure grid group -->

    <div class="pure-g">
      <div class="pure-u-1-1 small-font">
        <p>
            This visualisation is created by Lee Suet Yee.
        </p>
      </div>
    </div>


  </div>

  <script type="text/javascript">
    var specMap = "./map.vg.json";
    var specAgeCause = "./causes_by_agegroup_bar_chart.vg.json";
    var specBubble = "./death_rate_bubble_chart.vg.json";
    var specDiverging = "./death_rate_by_sex_bar_chart.vg.json";
    var specCausesOverTime = "./leading_causes_stacked_area_chart.vg.json";
    var specBump = "./death_rate_ranks_bump_chart.vg.json";

    vegaEmbed('#visMap', specMap, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);

    vegaEmbed('#visAgeCause', specAgeCause, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        viewAgeCause = result.view;

      // On first load, sync to the diverging chart's current YearSel if it's already available
      if (viewDiverging) {
        const currentYear = viewDiverging.signal('Year');
        viewAgeCause.signal('Year', currentYear).run();
      }
    }).catch(console.error);

    vegaEmbed('#visBubble', specBubble, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);

    vegaEmbed('#visDiverging', specDiverging, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        viewDiverging = result.view;

      // Whenever the slider changes in the diverging chart, push the value to the stacked bar
        viewDiverging.addSignalListener('Year', function (name, value) {
            if (viewAgeCause) {
            viewAgeCause.signal('Year', value).run();
            }
        });
    }).catch(console.error);

    vegaEmbed('#visCausesOverTime', specCausesOverTime, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);

    vegaEmbed('#visBump', specBump, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);
  </script>

</body>
</html>